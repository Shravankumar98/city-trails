---
// src/pages/places/[category].astro
import MainLayout from "../../layouts/MainLayout.astro";
import PlaceCard from "../../components/PlaceCard.astro";
import { places } from "../../data/places.js";

export async function getStaticPaths() {
  const categories = Array.from(new Set(places.map(p => p.category)));
  return categories.map(cat => ({ params: { category: cat.toLowerCase() } }));
}

const { category } = Astro.params;
const filteredPlaces = places.filter(
  p => p.category.toLowerCase() === category.toLowerCase()
);

if (!filteredPlaces.length) {
  return Astro.redirect("/places");
}

const titleCase = str =>
  str.replace(/\b\w/g, l => l.toUpperCase());
---
<MainLayout title={`${titleCase(category)} â€“ Places in Bangalore`}>
  
  <!-- HEADER -->
  <section class="relative h-[300px] md:h-[420px]">
    <img
      src={filteredPlaces[0]?.image || '/placeholder.svg'}
      alt={`${titleCase(category)} Places`}
      class="h-full w-full object-cover"
    />
    <div class="absolute inset-0 flex items-center justify-center bg-black/60 px-4">
      <h1 class="text-center text-3xl sm:text-4xl md:text-5xl font-bold text-white tracking-wide">
        {titleCase(category)}
      </h1>
    </div>
  </section>

  <!-- GRID -->
  <section class="container mx-auto px-4 sm:px-6 md:px-8 py-12 md:py-16">
    <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
      {filteredPlaces.map(place => (
        <PlaceCard place={place} />
      ))}
    </div>
  </section>

</MainLayout>
